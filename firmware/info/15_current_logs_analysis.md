# –†–µ–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ - –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏ –ø—Ä–æ–±–ª–µ–º–∞ "–∑–∞–≤–∏—Å–∞–Ω–∏—è"

## üìä **–†–µ–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ –ª–æ–≥–∞–º**

### **–û–±—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∞:**
–õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç **—Å–∏—Å—Ç–µ–º–∞ –ù–ï –∑–∞–≤–∏—Å–∞–µ—Ç** - –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ –∏—Å–ø—ã—Ç—ã–≤–∞–µ—Ç —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.

---

## üîç **–•—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Å–æ–±—ã—Ç–∏–π –∏–∑ –ª–æ–≥–æ–≤**

### **1. WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (—É—Å–ø–µ—à–Ω–æ)**
```
[3947-4079] –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–µ–π, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ISS_Alpha
[9146] WiFi connected: IP 192.168.1.41
```

### **2. Initial POST - –æ—Ç–ø—Ä–∞–≤–∫–∞ (–Ω–µ—É–¥–∞—á–Ω–æ)**
```
[9172] Sending initial POST on WiFi connect...
[12094] Full HTTP request being sent...
[132147] start_ssl_client: -1 ‚Üê SSL handshake fails —á–µ—Ä–µ–∑ 111 —Å–µ–∫—É–Ω–¥!
[132155] Cannot connect to server 84.252.143.212
[132166] Connection failed, request returned to queue for retry, queue size: 1
```

### **3. Retry —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å (–Ω–µ—É–¥–∞—á–Ω–æ)**
```
[132179] === QUEUE: Processing queue ===
[132193] Queue size: 1
[132260] Removed item from queue front
[132269] Queue size after removal: 0
[132290] doHttpPostFromData() - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
[–î–ª–∏–Ω–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ...]
[–í—Ç–æ—Ä–æ–π SSL handshake fails]
```

### **4. "–ó–∞–≤–∏—Å–∞–Ω–∏–µ" - –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞**
```
–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏ - –Ω–µ—Ç –Ω–æ–≤—ã—Ö –ª–æ–≥–æ–≤
–°–∏—Å—Ç–µ–º–∞ –∂–¥–µ—Ç LoRa –ø–∞–∫–µ—Ç–æ–≤ –∫–∞–∂–¥—ã–µ 500ms
```

---

## üö® **–ü—Ä–æ–±–ª–µ–º–∞ "–∑–∞–≤–∏—Å–∞–Ω–∏—è" - –†–ê–ó–û–ë–õ–ê–ß–ï–ù–ò–ï**

### **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ù–ê –°–ê–ú–û–ú –î–ï–õ–ï:**

**–°–∏—Å—Ç–µ–º–∞ –ù–ï –∑–∞–≤–∏—Å–∞–µ—Ç!** –û–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **LoRa-only —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è**.

```cpp
#define POST_INTERVAL_EN 0  // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ POST –æ—Ç–∫–ª—é—á–µ–Ω—ã
#define POST_EN_WHEN_LORA_RECEIVED 1  // POST —Ç–æ–ª—å–∫–æ –ø—Ä–∏ LoRa –ø–∞–∫–µ—Ç–∞—Ö
```

### **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```cpp
if (POST_INTERVAL_EN) {
  // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ POST –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫
} else {
  // LoRa-only —Ä–µ–∂–∏–º: –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –æ–∂–∏–¥–∞–Ω–∏—è
  while (true) {
    processPostQueue();  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Å—Ç–æ–π –æ—á–µ—Ä–µ–¥–∏
    vTaskDelay(500);     // –ñ–¥–µ–º LoRa –ø–∞–∫–µ—Ç—ã
  }
}
```

### **–ü–æ—á–µ–º—É –∫–∞–∂–µ—Ç—Å—è "–∑–∞–≤–∏—Å–∞–Ω–∏–µ":**
- ‚úÖ **–û—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞** - –Ω–µ—Ç LoRa –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ **POST_INTERVAL_EN=0** - –Ω–µ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö POST –¥–ª—è –ª–æ–≥–æ–≤
- ‚úÖ **ESP_LOGD()** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–≥–æ–≤ –æ–∂–∏–¥–∞–Ω–∏—è (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω)
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –∂–¥–µ—Ç** LoRa —Ç—Ä–∞—Ñ–∏–∫–∞ –∫–∞–∂–¥—ã–µ 500ms

---

## üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è**

### **WiFi:**
- ‚úÖ **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –£—Å–ø–µ—à–Ω–æ (–Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ 4WAY_HANDSHAKE_TIMEOUT)
- ‚úÖ **IP –∞–¥—Ä–µ—Å:** 192.168.1.41
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è

### **POST –º–µ—Ö–∞–Ω–∏–∑–º:**
- ‚úÖ **Initial POST:** –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
- ‚úÖ **Retry:** –†–∞–±–æ—Ç–∞–µ—Ç (POST –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å)
- ‚úÖ **–û—á–µ—Ä–µ–¥—å:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

### **–°–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå **SSL handshake:** Fails (-1) - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞
- ‚ùå **Server connection:** –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω 84.252.143.212:443
- ‚ùå **Response time:** 0ms (–Ω–µ—Ç —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤)

### **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**
- ‚úÖ **Heap:** 221440 bytes free (86%)
- ‚úÖ **Memory:** –°—Ç–∞–±–∏–ª—å–Ω–∞—è, –±–µ–∑ —É—Ç–µ—á–µ–∫
- ‚úÖ **Tasks:** –í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üéØ **–í—ã–≤–æ–¥—ã - —Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**

### **‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ü–†–ê–í–ò–õ–¨–ù–û:**
1. **WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** - —Å—Ç–∞–±–∏–ª—å–Ω–æ
2. **Retry –º–µ—Ö–∞–Ω–∏–∑–º** - POST –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å
3. **–û—á–µ—Ä–µ–¥—å** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
4. **Task scheduler** - –≤—Å–µ –∑–∞–¥–∞—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
5. **Memory management** - –±–µ–∑ –ø—Ä–æ–±–ª–µ–º

### **‚ùå –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. **SSL handshake fails (-1)** - —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
2. **–î–ª–∏–Ω–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ connect()** - 111 —Å–µ–∫—É–Ω–¥ –¥–æ —Ç–∞–π–º–∞—É—Ç–∞
3. **–ù–µ—Ç LoRa —Ç—Ä–∞—Ñ–∏–∫–∞** - –æ—á–µ—Ä–µ–¥—å –æ—Å—Ç–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π
4. **POST_INTERVAL_EN=0** - –Ω–µ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### **üîç –ü—Ä–∏—á–∏–Ω–∞ "–∑–∞–≤–∏—Å–∞–Ω–∏—è":**
**–ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è LoRa –ø–∞–∫–µ—Ç–æ–≤!**

---

## üí° **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–∑–∞–≤–∏—Å–∞–Ω–∏—è"**

### **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã:**
```cpp
#define POST_INTERVAL_EN 1  // –í–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ POST –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫
#define FAKE_LORA 1         // –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ LoRa –ø–∞–∫–µ—Ç—ã
#define USE_HTTPS 0         // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTP –≤–º–µ—Å—Ç–æ HTTPS
```

### **–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
```
WiFi connected: IP 192.168.1.41
[–ö–∞–∂–¥—ã–µ 10 —Å–µ–∫] POST Task: periodic mode enabled, sending periodic POST
LoRa packet received, signal_level_dbm=0
=== QUEUE: Adding new POST request ===
[–ö–∞–∂–¥—ã–µ 5 —Å–µ–∫] === QUEUE: Processing queue ===
```

---

## üìã **–ò—Ç–æ–≥–æ–≤–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ**

### **–°–∏—Å—Ç–µ–º–∞:**
- ‚úÖ **–ù–ï –∑–∞–≤–∏—Å–∞–µ—Ç** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–û–∂–∏–¥–∞–µ—Ç LoRa –ø–∞–∫–µ—Ç–æ–≤** - –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- ‚úÖ **Retry —Ä–∞–±–æ—Ç–∞–µ—Ç** - –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö
- ‚ùå **–ò–º–µ–µ—Ç —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã** - SSL handshake fails

### **–†–µ—à–µ–Ω–∏–µ "–ø—Ä–æ–±–ª–µ–º—ã":**
**–ù–µ –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞–≤–∏—Å–∞–Ω–∏—è, –∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ LoRa —Ç—Ä–∞—Ñ–∏–∫–∞ + —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã!**

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!** üöÄ
