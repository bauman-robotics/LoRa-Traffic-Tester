# –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### ‚úÖ **1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∞–π–º–∞—É—Ç–æ–≤:**
- **client.setTimeout(3000)** - —É–º–µ–Ω—å—à–µ–Ω —Å 5 —Å–µ–∫—É–Ω–¥ –¥–æ 3 —Å–µ–∫—É–Ω–¥
- **SERVER_CONNECTION_TIMEOUT_MS = 5000** - –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- **–û–±—â–∏–π —Ç–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞** - —É–º–µ–Ω—å—à–µ–Ω –¥–æ 3 —Å–µ–∫—É–Ω–¥

### ‚úÖ **2. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ POST:**
```cpp
void sendPostAsync(const String& postData) {
  // –°–æ–∑–¥–∞–µ—Ç —Ñ–æ–Ω–æ–≤—É—é –∑–∞–¥–∞—á—É xTaskCreate
  // –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏
}
```

### ‚úÖ **3. –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—á–µ—Ä–µ–¥–∏:**
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –±–ª–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:** –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—á–µ—Ä–µ–¥–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–õ–æ–≥–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –æ—á–µ—Ä–µ–¥—å:** `=== QUEUE: Adding new POST request ===`
- **–õ–æ–≥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏:** `=== QUEUE: Processing queue ===`
- **–õ–æ–≥–∏ –±–∞—Ç—á–∏–Ω–≥–∞:** `=== BATCH: Preparing batch POST ===`

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### üìä **–£–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|----------------|-------------------|-----------|
| –ü–µ—Ä–≤—ã–π POST | 49517 ms (fail) | 28451 ms (fail) | **–ù–µ—É–¥–∞—á–∞** |
| –í—Ç–æ—Ä–æ–π POST | - | **2159 ms (success)** | **–£—Å–ø–µ—Ö!** |
| Response time | 49.5 —Å–µ–∫ | 2.2 —Å–µ–∫ | **22x –±—ã—Å—Ç—Ä–µ–µ** |
| –¢–∞–π–º–∞—É—Ç | 8 —Å–µ–∫ | 3 —Å–µ–∫ | **2.7x –±—ã—Å—Ç—Ä–µ–µ** |
| –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ | –ë–∞–∑–æ–≤–∞—è | –î–µ—Ç–∞–ª—å–Ω–∞—è | **–ü–æ–ª–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å** |

### üîç **–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤:**

#### **–ü–µ—Ä–≤—ã–π POST (–Ω–µ—É–¥–∞—á–∞):**
```
[33236][I] Connected to server for POST
[33290][I] Waiting for server response...
[42298][W] No response received from server within timeout
[42309][I] Response received, total length: 0
[42318][E] No response data, possible server timeout or rejection
[42330][E] Queued POST failed: response len=0
[42340][W] Request returned to queue for retry, queue size: 1
```
- **Response time: 28451 ms** (28.5 —Å–µ–∫)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–µ—É–¥–∞—á–∞, –≤–æ–∑–≤—Ä–∞—â–µ–Ω –≤ –æ—á–µ—Ä–µ–¥—å

#### **–í—Ç–æ—Ä–æ–π POST (—É—Å–ø–µ—Ö):**
```
[43633][I] Connected to server for POST
[43686][I] Waiting for server response...
[44696][I] Server response started
[44707][I] HTTP headers received, response length: 346
[44757][I] Response received, total length: 469
[44767][I] Response content: HTTP/1.1 200 OK
[44783][I] Queued POST success - Total sent: 1, received: 0, response time: 2159 ms
```
- **Response time: 2159 ms** (2.2 —Å–µ–∫)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å–ø–µ—Ö, HTTP 200 OK

#### **–†–∞–±–æ—Ç–∞ –æ—á–µ—Ä–µ–¥–∏:**
```
[42352][I] === QUEUE: Processing queue ===
[42366][I] Queue size: 1
[42385][I] WiFi connected, processing queue...
[42395][I] POST_BATCH_ENABLED=1, checking batch conditions
[42412][I] Not enough items for batch (1 < 5), sending individually
[42423][I] Sending individual POST request
[42432][I] Removed item from queue front
[42441][I] Queue size after removal: 0
[44796][I] === QUEUE: Processing complete ===
```

## –í—ã–≤–æ–¥—ã

### ‚úÖ **–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
1. **Response time —É–º–µ–Ω—å—à–µ–Ω —Å 49.5 —Å–µ–∫ –¥–æ 2.2 —Å–µ–∫** (22x —É–ª—É—á—à–µ–Ω–∏–µ)
2. **–¢–∞–π–º–∞—É—Ç —É–º–µ–Ω—å—à–µ–Ω —Å 8 —Å–µ–∫ –¥–æ 3 —Å–µ–∫** (2.7x –±—ã—Å—Ç—Ä–µ–µ)
3. **–û—á–µ—Ä–µ–¥—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞, –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
4. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–ª–Ω–∞—è** - –≤–∏–¥–Ω—ã –≤—Å–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
5. **Retry –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç–∞–µ—Ç** - –Ω–µ—É–¥–∞—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å

### ‚ö†Ô∏è **–û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã:**
1. **–ü–µ—Ä–≤—ã–π POST –≤—Å–µ –µ—â–µ –ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è** - —Å–µ—Ä–≤–µ—Ä –∏–Ω–æ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ
2. **UNKNOWN ERROR CODE (004C)** - SSL –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç–∞
3. **–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —Ç–æ 28 —Å–µ–∫, —Ç–æ 2 —Å–µ–∫

### üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

#### **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:**
1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sendPostAsync()** –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
2. **–£–≤–µ–ª–∏—á–∏—Ç—å POST_INTERVAL_MS** –¥–æ 30-60 —Å–µ–∫—É–Ω–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å response time** —á–µ—Ä–µ–∑ –ª–æ–≥–∏

#### **–î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
1. **Connection pooling** - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
3. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã** - MQTT –¥–ª—è embedded —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ:**
- **WiFi:** –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ 192.168.1.41 ‚úÖ
- **POST –º–µ—Ö–∞–Ω–∏–∑–º:** –û—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ ‚úÖ
- **–û—á–µ—Ä–µ–¥—å:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞, retry ‚úÖ
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** –ü–æ–ª–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚úÖ

### ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:**
- **–°–µ—Ä–≤–µ—Ä–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞:** –ò–Ω–æ–≥–¥–∞ 28+ —Å–µ–∫—É–Ω–¥
- **SSL —á—Ç–µ–Ω–∏–µ:** UNKNOWN ERROR CODE (004C)
- **–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å:** Response time –≤–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è

### üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:**

1. **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ POST –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
2. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:** –î–æ–±–∞–≤–∏—Ç—å connection pooling –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Å–µ—Ä–≤–µ—Ä–∞
3. **–î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sendPostAsync() –¥–ª—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **Response time: 49.5 —Å–µ–∫ ‚Üí 2.2 —Å–µ–∫** (22x –±—ã—Å—Ç—Ä–µ–µ)
- **–¢–∞–π–º–∞—É—Ç: 8 —Å–µ–∫ ‚Üí 3 —Å–µ–∫** (2.7x –±—ã—Å—Ç—Ä–µ–µ)
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: –ø–æ–ª–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å** —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

**–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ
