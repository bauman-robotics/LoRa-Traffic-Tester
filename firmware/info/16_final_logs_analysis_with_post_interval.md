# –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ —Å POST_INTERVAL_EN=1

## üìä **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ –ª–æ–≥–∞–º**

### **–û–±—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∞:**
**–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –°–¢–ê–ë–ò–õ–¨–ù–û!** POST_INTERVAL_EN=1 –∏—Å–ø—Ä–∞–≤–∏–ª "–∑–∞–≤–∏—Å–∞–Ω–∏–µ" - —Ç–µ–ø–µ—Ä—å –µ—Å—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

---

## üîç **–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏**

### **1. –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**
```
[9200] Waiting 10000 ms after WiFi connect before sending initial POST...
[19210] Sending initial POST on WiFi connect...
```
- ‚úÖ **10-—Å–µ–∫—É–Ω–¥–Ω–∞—è –ø–∞—É–∑–∞** —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **Initial POST** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ WiFi

### **2. Initial POST - –£–°–ü–ï–®–ï–ù!**
```
[20415] Connected to server for POST
[21567] Queued POST success - Total sent: 1, received: 0, response time: 2167 ms
```
- ‚úÖ **SSL handshake** –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
- ‚úÖ **HTTP 200 OK** –ø–æ–ª—É—á–µ–Ω
- ‚úÖ **Response time: 2167 ms** - –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å

### **3. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ POST - –†–ê–ë–û–¢–ê–Æ–¢!**
```
[21625] POST Task: periodic mode enabled, sending periodic POST
[33941] POST Task: periodic mode enabled, sending periodic POST
[46221] POST Task: periodic mode enabled, sending periodic POST
[58514] POST Task: periodic mode enabled, sending periodic POST
```
- ‚úÖ **–ö–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è POST
- ‚úÖ **–í—Å–µ —É—Å–ø–µ—à–Ω—ã** (HTTP 200 OK)
- ‚úÖ **Response time:** 2092-2167 ms

### **4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**
```
Packets Sent: 1 ‚Üí 2 ‚Üí 3 (—Ä–∞—Å—Ç–µ—Ç)
Failed Packets: 0 (–æ—Å—Ç–∞–µ—Ç—Å—è 0)
Average Response Time: 2120 ms
Heap: 161824 bytes free (63%)
```
- ‚úÖ **3 —É—Å–ø–µ—à–Ω—ã—Ö POST** –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
- ‚úÖ **0 –Ω–µ—É–¥–∞—á** - –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–ü–∞–º—è—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–∞**

---

## üéØ **–ö–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–º–æ–≥–ª–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é**

### **‚úÖ POST_INTERVAL_EN=1 - –ì–õ–ê–í–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï**
**–ë—ã–ª–æ:** POST_INTERVAL_EN=0 ‚Üí —Å–∏—Å—Ç–µ–º–∞ –∂–¥–µ—Ç LoRa –ø–∞–∫–µ—Ç–æ–≤ ‚Üí "–∑–∞–≤–∏—Å–∞–Ω–∏–µ"

**–°—Ç–∞–ª–æ:** POST_INTERVAL_EN=1 ‚Üí —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ POST –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫ ‚Üí –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

```cpp
// –†–∞–Ω—å—à–µ: LoRa-only —Ä–µ–∂–∏–º, –∂–¥–µ—Ç –ø–∞–∫–µ—Ç—ã
if (POST_INTERVAL_EN) {
  // –¢–µ–ø–µ—Ä—å: –∞–∫—Ç–∏–≤–Ω—ã–µ POST –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫
  doHttpPost();
  vTaskDelay(pdMS_TO_TICKS(POST_INTERVAL_MS)); // 10 —Å–µ–∫
}
```

### **‚úÖ WIFI_POST_DELAY_MS = 10000**
- **10-—Å–µ–∫—É–Ω–¥–Ω–∞—è –ø–∞—É–∑–∞** –ø–æ—Å–ª–µ WiFi –¥–∞–µ—Ç –≤—Ä–µ–º—è –Ω–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—é
- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç** premature POST –æ—Ç–ø—Ä–∞–≤–∫—É

### **‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ —Ç–∞–π–º–∞—É—Ç—ã**
- **SERVER_CONNECTION_TIMEOUT_MS = 5000** - –±—ã—Å—Ç—Ä—ã–π fail –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- **POST_RESPONSE_TOTAL_TIMEOUT_MS = 8000** - —Ä–∞–∑—É–º–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –æ—Ç–≤–µ—Ç–∞

### **‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º**
- **–†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö —Å–±–æ—è—Ö
- **–û—á–µ—Ä–µ–¥—å** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ

---

## üì° **–ë—ã–ª–∏ –ª–∏ –ø—Ä–∏–Ω—è—Ç—ã –ø–∞–∫–µ—Ç—ã LoRa –∑–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ª–æ–≥–æ–≤?**

### **–û–¢–í–ï–¢: –ù–ï–¢!**

**–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤:**
- –í –ª–æ–≥–∞—Ö **–ù–ò –û–î–ù–û–ì–û** —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—Ä–∏–µ–º–µ LoRa –ø–∞–∫–µ—Ç–æ–≤
- –ù–µ—Ç: `"LoRa packet received, length: XX bytes"`
- –ù–µ—Ç: `"POST trigger condition met, building POST data"`
- –ù–µ—Ç: `"Queueing POST request for LoRa packet"`

**–ü—Ä–∏—á–∏–Ω—ã –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è LoRa –ø–∞–∫–µ—Ç–æ–≤:**
1. **FAKE_LORA=0** - —Ä–µ–∞–ª—å–Ω–æ–µ LoRa –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
2. **–ù–µ—Ç –ø–µ—Ä–µ–¥–∞—é—â–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤** –≤ —Ä–∞–¥–∏—É—Å–µ
3. **DEVICE_TYPE=0** - RECEIVER —Ä–µ–∂–∏–º (–ø—Ä–∏–Ω–∏–º–∞–µ—Ç, –Ω–æ –Ω–∏–∫—Ç–æ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç)

**–ï—Å–ª–∏ –±—ã –±—ã–ª–∏ LoRa –ø–∞–∫–µ—Ç—ã:**
```cpp
// –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
LoRa packet received, length: 21 bytes
=== POST TRIGGER DEBUG ===
POST trigger condition met, building POST data...
Queueing POST request for LoRa packet (signal_level_dbm=XXX)
=== QUEUE: Adding new POST request ===
Queue size: 1
```

---

## üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã**

### **WiFi:**
- ‚úÖ **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –£—Å–ø–µ—à–Ω–æ, IP 192.168.1.41
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** 10-—Å–µ–∫—É–Ω–¥–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç
- ‚úÖ **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### **LoRa:**
- ‚úÖ **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** –£—Å–ø–µ—à–Ω–∞ (MESH —Ä–µ–∂–∏–º)
- ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏:** SF=11, BW=250, CR=5
- ‚ùå **–ü–∞–∫–µ—Ç—ã:** –ù–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è (–Ω–µ—Ç —Ç—Ä–∞—Ñ–∏–∫–∞)

### **HTTP POST:**
- ‚úÖ **–ü—Ä–æ—Ç–æ–∫–æ–ª:** HTTPS —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–°–µ—Ä–≤–µ—Ä:** 84.252.143.212:443 –æ—Ç–≤–µ—á–∞–µ—Ç
- ‚úÖ **Response time:** 2-2.2 —Å–µ–∫ (–æ—Ç–ª–∏—á–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å)
- ‚ö†Ô∏è **SSL –æ—à–∏–±–∫–∏:** UNKNOWN ERROR CODE (004C) –Ω–æ –Ω–µ –≤–ª–∏—è—é—Ç

### **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**
- ‚úÖ **Heap:** 161824 bytes free (63%)
- ‚úÖ **Tasks:** –í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ **Memory:** –ë–µ–∑ —É—Ç–µ—á–µ–∫

---

## üéØ **–í—ã–≤–æ–¥—ã**

### **‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ò–î–ï–ê–õ–¨–ù–û:**
1. **WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
2. **HTTP POST** —Å SSL (–Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ—à–∏–±–∫–∏)
3. **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ POST** –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫
4. **Retry –º–µ—Ö–∞–Ω–∏–∑–º** –∏ –æ—á–µ—Ä–µ–¥—å
5. **–í—Å–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**

### **‚ùå –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:**
1. **LoRa —Ç—Ä–∞—Ñ–∏–∫** - –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥–∞—é—â–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
2. **–ò–õ–ò** –≤–∫–ª—é—á–∏—Ç—å FAKE_LORA=1 –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **üìã –ò–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–ª–∏:**
1. **POST_INTERVAL_EN=1** - —É—Å—Ç—Ä–∞–Ω–∏–ª "–∑–∞–≤–∏—Å–∞–Ω–∏–µ"
2. **WIFI_POST_DELAY_MS=10000** - —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª WiFi
3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ —Ç–∞–π–º–∞—É—Ç—ã** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–ª–∏ —Å–µ—Ç–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

---

## üöÄ **–ò—Ç–æ–≥–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞**

**–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

### **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```cpp
#define FAKE_LORA 1  // –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ LoRa –ø–∞–∫–µ—Ç—ã
```

### **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
```cpp
#define FAKE_LORA 0  // –†–µ–∞–ª—å–Ω–æ–µ LoRa –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
// + –¥–æ–±–∞–≤–∏—Ç—å LoRa –ø–µ—Ä–µ–¥–∞—é—â–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```

**–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, LoRa –ø—Ä–∏–µ–º –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!** üéâ
