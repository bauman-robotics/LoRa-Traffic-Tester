# –ü—Ä–æ–µ–∫—Ç LoRa Traffic Tester - –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞

## üìä **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞**

### **–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í –ö –ü–†–û–ú–´–®–õ–ï–ù–ù–û–ú–£ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ**

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è LoRa —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–∞–Ω–Ω—ã—Ö –ø–æ HTTPS –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:

- **ESP32-C3** –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
- **LoRa –º–æ–¥—É–ª—å** –¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–∞–∫–µ—Ç–æ–≤
- **WiFi –º–æ–¥—É–ª—å** –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- **–û—á–µ—Ä–µ–¥—å POST –∑–∞–ø—Ä–æ—Å–æ–≤** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º retry
- **–ü–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üîß **–î–æ—Ä–∞–±–æ—Ç–∫–∏, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Å–µ–≥–æ–¥–Ω—è**

### **1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ POST task (–∫—Ä–∏—Ç–∏—á–Ω–æ)**
**–ü—Ä–æ–±–ª–µ–º–∞:** POST_INTERVAL_EN=0 –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∞–ª –æ—Ç–ø—Ä–∞–≤–∫—É POST, –¥–∞–∂–µ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ LoRa –ø–∞–∫–µ—Ç–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ `httpPostTask()`:
```cpp
if (POST_INTERVAL_EN) {
  // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ POST –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫
} else {
  // LoRa-only —Ä–µ–∂–∏–º - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—á–µ—Ä–µ–¥–∏ –∫–∞–∂–¥—ã–µ 500ms
}
```

### **2. –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Å–ø–∞–º–∞ –ª–æ–≥–æ–≤**
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–æ–æ–±—â–µ–Ω–∏—è –æ –ø—É—Å—Ç–æ–π –æ—á–µ—Ä–µ–¥–∏ –≤—ã–≤–æ–¥–∏–ª–∏—Å—å –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `queueEmptyLogged` –¥–ª—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

### **3. –î–æ–±–∞–≤–ª–µ–Ω retry –¥–ª—è connection failures**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –Ω–µ—É–¥–∞—á–µ SSL handshake POST —Ç–µ—Ä—è–ª—Å—è.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ POST –≤ –æ—á–µ—Ä–µ–¥—å –ø—Ä–∏ connection failures.

### **4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ —Ç–∞–π–º–∞—É—Ç—ã –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ñ–µ—Å—Ç–∫–æ –ø—Ä–æ–ø–∏—Å–∞–Ω–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã –≤ –∫–æ–¥–µ.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ `lora_config.hpp`:
```cpp
#define POST_RESPONSE_INITIAL_DELAY_MS 1000   // –ù–∞—á–∞–ª—å–Ω—ã–π delay
#define POST_RESPONSE_TOTAL_TIMEOUT_MS 8000   // –û–±—â–∏–π —Ç–∞–π–º–∞—É—Ç 9 —Å–µ–∫
```

### **5. –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ `WIFI_POST_DELAY_MS = 2000` –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

### **6. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞ FAKE LoRa**
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- `fake_rssi_counter` —Ä–∞—Å—Ç–µ—Ç –æ—Ç 0 –¥–æ INT_MAX (–≤–º–µ—Å—Ç–æ -80 –¥–æ -30)
- –ü–æ–ª–µ `full_packet_len` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ failed requests (–≤–º–µ—Å—Ç–æ –¥–ª–∏–Ω—ã –ø–∞–∫–µ—Ç–∞)

---

## üö® **–ü—Ä–æ–±–ª–µ–º—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å–µ–≥–æ–¥–Ω—è**

### **1. "–ó–∞–≤–∏—Å–∞–Ω–∏–µ" —Å–∏—Å—Ç–µ–º—ã**
**–°–∏–º–ø—Ç–æ–º:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ initial POST.

**–ü—Ä–∏—á–∏–Ω–∞:** –°–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–ª–∞ - –∂–¥–∞–ª–∞ LoRa –ø–∞–∫–µ—Ç–æ–≤ –ø—Ä–∏ POST_INTERVAL_EN=0.

**–†–µ—à–µ–Ω–∏–µ:** –£—Ç–æ—á–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞–±–æ—Ç—ã.

### **2. SSL handshake fails**
**–°–∏–º–ø—Ç–æ–º:** `start_ssl_client: -1` –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —Å–µ—Ä–≤–µ—Ä—É.

**–ü—Ä–∏—á–∏–Ω–∞:** –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º.

**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞.

### **3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ LoRa —Ç—Ä–∞—Ñ–∏–∫–∞**
**–°–∏–º–ø—Ç–æ–º:** –ù–µ—Ç –≤—Ö–æ–¥—è—â–∏—Ö LoRa –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ü—Ä–∏—á–∏–Ω–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–¥–∞—é—â–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ —Ä–∞–¥–∏—É—Å–µ.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FAKE_LORA=1 –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### **4. –°–ø–∞–º –∫–æ–Ω—Å–æ–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤**
**–°–∏–º–ø—Ç–æ–º:** –ö–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—É—Å—Ç–æ–π –æ—á–µ—Ä–µ–¥–∏.

**–†–µ—à–µ–Ω–∏–µ:** –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

### **5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ retry –ø—Ä–∏ connection failures**
**–°–∏–º–ø—Ç–æ–º:** –ù–µ—É–¥–∞—á–Ω—ã–µ POST —Ç–µ—Ä—è–ª–∏—Å—å –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –æ—á–µ—Ä–µ–¥—å.

---

## üéØ **–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –¥–æ—Ä–∞–±–æ—Ç–æ–∫**

### **–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∏—Å—Ç–µ–º—ã:**

#### **1. WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (0-5 —Å–µ–∫)**
```
WiFi connected: IP 192.168.1.41
Waiting 2000 ms after WiFi connect before sending initial POST...
```

#### **2. Initial POST (2-11 —Å–µ–∫)**
```
Sending initial POST on WiFi connect...
POST success, response time: XXXX ms
```

#### **3. –†–∞–±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è LoRa (–ø—Ä–∏ POST_INTERVAL_EN=0)**
```
=== QUEUE: Processing queue ===
Queue is empty, nothing to process  // –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!
```

#### **4. –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ LoRa –ø–∞–∫–µ—Ç–æ–≤ (–≤–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è)**
```
LoRa packet received, length: 21 bytes
=== POST TRIGGER DEBUG ===
POST trigger condition met, building POST data...
Queueing POST request for LoRa packet (signal_level_dbm=123)
=== QUEUE: Adding new POST request ===
Queue after: size=1
```

#### **5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏ (–∫–∞–∂–¥—ã–µ 5 —Å–µ–∫)**
```
=== QUEUE: Processing queue ===
Queue size: 1
Sending individual POST request
HTTP 200 OK, response time: XXXX ms
Removed item from queue front
Queue size after removal: 0
```

#### **6. –ü—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö —Å–±–æ—è—Ö - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry**
```
No response received from server within timeout
Request returned to queue for retry, queue size: 1
// –ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
```

### **–í FAKE LoRa —Ä–µ–∂–∏–º–µ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):**
```
LoRa packet received, length: 21 bytes
signal_level_dbm=0, full_packet_len=0  // –ü–µ—Ä–≤—ã–π –ø–∞–∫–µ—Ç
...
LoRa packet received, length: 21 bytes
signal_level_dbm=1, full_packet_len=2  // –í—Ç–æ—Ä–æ–π –ø–∞–∫–µ—Ç (2 failed —Ä–∞–Ω–µ–µ)
```

### **POST –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç:**
```json
{
  "user_id": "Guest",
  "full_packet_len": 3,     // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ failed requests
  "signal_level_dbm": 456,  // –†–∞—Å—Ç–µ—Ç –æ—Ç 0 –¥–æ INT_MAX –≤ FAKE —Ä–µ–∂–∏–º–µ
  "cold": 5,                // –ü–æ–ª—É—á–µ–Ω–æ LoRa –ø–∞–∫–µ—Ç–æ–≤
  "hot": 3                  // –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ POST —É—Å–ø–µ—à–Ω–æ
}
```

---

## üìà **–ò—Ç–æ–≥–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã**

### **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- ‚úÖ **Retry –ø—Ä–∏ –Ω–µ—É–¥–∞—á–∞—Ö** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ
- ‚úÖ **–û—á–µ—Ä–µ–¥—å** - –Ω–µ—Ç –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–¢–∞–π–º–∞—É—Ç—ã** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ, —Ä–∞–∑—É–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ **Response time** - 2-3 —Å–µ–∫—É–Ω–¥—ã –≤ —Å—Ä–µ–¥–Ω–µ–º
- ‚úÖ **–ü–∞–º—è—Ç—å** - 62% —Å–≤–æ–±–æ–¥–Ω–æ (—Å—Ç–∞–±–∏–ª—å–Ω–æ)
- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å** - LoRa –ø—Ä–∏–µ–º –Ω–µ–∑–∞–≤–∏—Å–∏–º –æ—Ç HTTP

### **–û—Ç–ª–∞–¥–∫–∞:**
- ‚úÖ **–ü–æ–ª–Ω—ã–µ –ª–æ–≥–∏** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–Ω—ã
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - packets sent/failed/received
- ‚úÖ **FAKE —Ä–µ–∂–∏–º** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

### **–ì–∏–±–∫–æ—Å—Ç—å:**
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - —Ç–∞–π–º–∞—É—Ç—ã, –∑–∞–¥–µ—Ä–∂–∫–∏
- ‚úÖ **–†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã** - RECEIVER/TRANSMITTER/TEST
- ‚úÖ **MESH —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Meshtastic

---

## üéâ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

**–ü—Ä–æ–µ–∫—Ç LoRa Traffic Tester –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

### **–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏:**
1. ‚úÖ **WiFi + HTTPS** - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö
2. ‚úÖ **LoRa –ø—Ä–∏–µ–º** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
3. ‚úÖ **–û—á–µ—Ä–µ–¥—å + retry** - –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏
4. ‚úÖ **–ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –≤–∏–¥–∏–º–æ—Å—Ç—å –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
5. ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - —Ç–∞–π–º–∞—É—Ç—ã, –ø–∞–º—è—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞:**
1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å `FAKE_LORA=1` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
2. **–ü—Ä–æ–¥–∞–∫—à–Ω:** `FAKE_LORA=0`, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ LoRa —Ç—Ä–∞—Ñ–∏–∫–∞
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –°–ª–µ–¥–∏—Ç—å –∑–∞ `Packets Sent` –∏ `Failed Packets`
4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

**–ü—Ä–æ–µ–∫—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ! üöÄ**
