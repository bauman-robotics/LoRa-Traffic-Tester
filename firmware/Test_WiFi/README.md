# WiFi Power Consumption Test Project

–ü—Ä–æ–µ–∫—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ WiFi –º–æ–¥—É–ª—è ESP32 –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ HTTP POST –∑–∞–ø—Ä–æ—Å–æ–≤.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç ESP32 –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WiFi —Å–µ—Ç–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥. –ü—Ä–æ–µ–∫—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ WiFi –º–æ–¥—É–ª—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WiFi
- –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä (hot/cold –∑–Ω–∞—á–µ–Ω–∏—è)
- –°—Ç–∞—Ç—É—Å LED –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–π–ª–∞ `lib/network_definitions/fake_test_network_definitions.h` 
–∏ –ø—Ä–æ–ø–∏—à–∏—Ç–µ –∫ –Ω–µ–º—É –ø—É—Ç—å –≤ wifi_test_config.hpp:

//#define USE_SYSTEM_NETWORK

#ifdef USE_SYSTEM_NETWORK
#include "../../../test_network_definitions.h"
#else
#include "lib/network_definitions/fake_test_network_definitions.h"
 // Fallback defaults
#endif

```cpp
#define DEFAULT_WIFI_SSID "–í–ê–®_WIFI_SSID"
#define DEFAULT_WIFI_PASSWORD "–í–ê–®_WIFI_PASSWORD"
#define DEFAULT_API_KEY "–≤–∞—à_api_–∫–ª—é—á_—Å–µ—Ä–≤–µ—Ä–∞"
#define DEFAULT_USER_ID "test_device"
#define DEFAULT_SERVER_IP "192.168.1.100"  // IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–í —Ñ–∞–π–ª–µ `wifi_test_config.hpp` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–µ—Ñ–∞–π–Ω—ã:
```cpp
#define POST_INTERVAL_MS 10000  // –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ (–º—Å)
```

## üöÄ –°–±–æ—Ä–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
python scripts/build.py

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ ESP32
python scripts/upload.py

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
python scripts/monitor.py
```

### –†—É—á–Ω–∞—è —Å–±–æ—Ä–∫–∞:
```bash
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PlatformIO (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
pio init --ide vscode

# –°–±–æ—Ä–∫–∞
pio run

# –ó–∞–≥—Ä—É–∑–∫–∞
pio run --target upload

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pio device monitor
```

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:
1. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ ESP32
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∞–º–ø–µ—Ä–º–µ—Ç—Ä –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ç–æ–∫–∞
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: `python scripts/monitor.py`

### –ò–∑–º–µ—Ä—è–µ–º—ã–µ –≤–µ–ª–∏—á–∏–Ω—ã:
- **–¢–æ–∫ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ WiFi** (~80-150 –º–ê)
- **–¢–æ–∫ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ POST** (–ø–∏–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
- **–°—Ä–µ–¥–Ω–∏–π —Ç–æ–∫** –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ
- **–¢–æ–∫ –ø—Ä–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏**

### –¢–∏–ø–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: 80-150 –º–ê
- –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö: 150-200 –º–ê (–ø–∏–∫–∏)
- –ü—Ä–æ—Å—Ç–æ–π (idle): 70-100 –º–ê

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Test_WiFi/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ main.cpp                    # –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ network_definitions/
‚îÇ       ‚îî‚îÄ‚îÄ fake_test_network_definitions.h  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏
‚îú‚îÄ‚îÄ wifi_manager_simple.hpp         # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å WiFi –º–µ–Ω–µ–¥–∂–µ—Ä–∞
‚îú‚îÄ‚îÄ wifi_manager_simple.cpp         # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è WiFi –º–µ–Ω–µ–¥–∂–µ—Ä–∞
‚îú‚îÄ‚îÄ wifi_test_config.hpp            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ platformio.ini                  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PlatformIO
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ build.py                    # –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ upload.py                   # –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ monitor.py                  # –°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îÇ   ‚îî‚îÄ‚îÄ pre_build.py                # Pre-build –ø—Ä–æ–≤–µ—Ä–∫–∏
‚îî‚îÄ‚îÄ README.md                       # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üîç –õ–æ–≥–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
```
WiFiTest: WiFi connected! IP: 192.168.1.123
WiFiTest: POST #1: cold=1, hot=0
WiFiTest: POST #1 successful (cold=1)
```

### –ü—Ä–æ–±–ª–µ–º—ã:
- **WiFi –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSID/–ø–∞—Ä–æ–ª—å –≤ network_definitions.h
- **–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø–æ—Ä—Ç
- **–û—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PlatformIO

## ‚öôÔ∏è –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π hot/cold —á–µ—Ä–µ–∑ API, –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–Ω–∏ –∑–∞–¥–∞—é—Ç—Å—è –¥–µ—Ñ–∞–π–Ω–∞–º–∏ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

## üîå –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ

- ESP32 Dev Board
- USB –∫–∞–±–µ–ª—å –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- –ê–º–ø–µ—Ä–º–µ—Ç—Ä –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
- WiFi —Ä–æ—É—Ç–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –°–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–∏–µ–º–∞ POST –∑–∞–ø—Ä–æ—Å–æ–≤

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π

### 1. PlatformIO –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
```bash
pip install platformio
```

### 2. –ù–µ –Ω–∞—à–ª–∏—Å—å serial –ø–æ—Ä—Ç—ã:
```bash
# Linux
sudo usermod -a -G dialout $USER
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
python -c "import serial.tools.list_ports; print(list(serial.tools.list_ports.comports()))"
```

### 3. –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:
- –ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ BOOT –∫–Ω–æ–ø–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å COM –ø–æ—Ä—Ç–∞ –≤ platformio.ini
